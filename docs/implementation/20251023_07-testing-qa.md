# Phase 7: テスト＆QA - 詳細実装ガイド

**Phase**: 7/8
**推定時間**: 3時間
**前提条件**: Phase 1-6完了
**次のPhase**: Phase 8 - Vercelデプロイ＆プレリリース

---

## 目次

1. [概要](#概要)
2. [テスト戦略](#テスト戦略)
3. [機能テスト](#機能テスト)
4. [クロスブラウザテスト](#クロスブラウザテスト)
5. [デバイステスト](#デバイステスト)
6. [パフォーマンステスト](#パフォーマンステスト)
7. [セキュリティチェック](#セキュリティチェック)
8. [アクセシビリティテスト](#アクセシビリティテスト)
9. [バグ修正](#バグ修正)
10. [成果物チェックリスト](#成果物チェックリスト)

---

## 概要

Phase 7では、AIパパっと要約 & 感想ジェネレーターの品質保証を行います。機能テスト、クロスブラウザテスト、デバイステスト、セキュリティチェックを実施し、本番リリースに向けた最終確認を行います。

### このPhaseで実現すること

- 全機能の動作確認
- クロスブラウザ互換性の確認
- レスポンシブデザインの検証
- パフォーマンステスト（Lighthouse）
- セキュリティ脆弱性のチェック
- アクセシビリティの確認
- バグ修正とドキュメント更新

---

## テスト戦略

### テストレベル

| テストレベル | 目的 | 実施方法 |
|------------|------|---------|
| **機能テスト** | 各機能が仕様通り動作するか | 手動テスト |
| **クロスブラウザテスト** | 複数のブラウザで動作するか | 手動テスト |
| **デバイステスト** | スマホ・タブレット・PCで動作するか | 手動テスト + DevTools |
| **パフォーマンステスト** | ページ速度、レスポンスタイム | Lighthouse |
| **セキュリティテスト** | XSS、SQLインジェクション等 | 手動チェック |
| **アクセシビリティテスト** | スクリーンリーダー対応等 | Lighthouse + 手動 |

---

## 機能テスト

### ステップ 1: URL入力機能のテスト

#### テストケース 1-1: 正常なURL入力

**手順:**
1. ホームページにアクセス
2. URL入力フォームに有効なURLを入力
   - テストURL: `https://example.com/article`
3. 「要約生成」ボタンをクリック

**期待される結果:**
- ローディング状態が表示される
- 5秒以内に要約が生成される
- 3行の要約が表示される
- 3パターンの感想コメントが表示される

#### テストケース 1-2: 無効なURL入力

**手順:**
1. URL入力フォームに無効なURLを入力
   - テストケース: `invalid-url`、`http://`、`ftp://example.com`
2. 「要約生成」ボタンをクリック

**期待される結果:**
- エラーメッセージが表示される
- エラーメッセージが分かりやすい

#### テストケース 1-3: 空のURL

**手順:**
1. URL入力フォームを空のままにする
2. 「要約生成」ボタンをクリック

**期待される結果:**
- バリデーションエラーが表示される
- フォームがsubmitされない

### ステップ 2: 要約生成機能のテスト

#### テストケース 2-1: 正常な要約生成

**手順:**
1. 有効な記事URLを入力
2. 要約が生成されるまで待つ

**期待される結果:**
- 3行の要約が生成される
- 各行が40〜60文字程度
- 記事の内容を正確に要約している

#### テストケース 2-2: 長い記事の要約

**手順:**
1. 5000文字以上の長い記事URLを入力
2. 要約が生成されるまで待つ

**期待される結果:**
- タイムアウトせずに要約が生成される
- 要約が記事の主要ポイントを捉えている

### ステップ 3: 感想コメント生成のテスト

#### テストケース 3-1: 3パターン生成

**手順:**
1. 要約生成完了後、感想コメントを確認

**期待される結果:**
- 3パターンの感想コメントが表示される
- 各コメントが異なる視点を提供している
- 各コメントが50〜80文字程度

#### テストケース 3-2: トーン変更

**手順:**
1. トーン設定を「casual」「formal」「neutral」に変更
2. それぞれで感想を生成

**期待される結果:**
- トーンに応じた表現が使われている
- casual: 親しみやすい表現
- formal: ビジネス的な表現
- neutral: 中立的な表現

### ステップ 4: コピー機能のテスト

#### テストケース 4-1: 要約のコピー

**手順:**
1. 要約のコピーボタンをクリック
2. テキストエディタに貼り付け

**期待される結果:**
- クリップボードに要約がコピーされる
- 改行が正しく保持されている
- コピー成功のフィードバックが表示される

#### テストケース 4-2: 感想コメントのコピー

**手順:**
1. 各感想コメントのコピーボタンをクリック
2. テキストエディタに貼り付け

**期待される結果:**
- クリップボードに感想がコピーされる
- コピー成功のフィードバックが表示される

### ステップ 5: 履歴機能のテスト

#### テストケース 5-1: 履歴保存

**手順:**
1. 複数の記事を要約
2. 履歴ページにアクセス

**期待される結果:**
- すべての要約履歴が表示される
- 新しい順に並んでいる
- 各履歴に記事タイトル、URL、日時が表示される

#### テストケース 5-2: 履歴削除

**手順:**
1. 履歴ページで削除ボタンをクリック
2. 確認ダイアログで「削除」を選択

**期待される結果:**
- 履歴が削除される
- リストから消える
- 削除成功のフィードバックが表示される

---

## クロスブラウザテスト

### ステップ 6: 対応ブラウザでのテスト

#### テスト対象ブラウザ

| ブラウザ | バージョン | 優先度 |
|---------|----------|--------|
| Google Chrome | 最新版 | 高 |
| Firefox | 最新版 | 高 |
| Safari | 最新版 | 高 |
| Microsoft Edge | 最新版 | 中 |
| Safari (iOS) | 最新版 | 高 |
| Chrome (Android) | 最新版 | 高 |

#### テスト項目

各ブラウザで以下を確認:

- [ ] ページが正しく表示される
- [ ] フォームが正常に動作する
- [ ] ボタンがクリックできる
- [ ] スタイルが崩れていない
- [ ] コピー機能が動作する
- [ ] エラーメッセージが表示される
- [ ] レスポンシブデザインが機能する

---

## デバイステスト

### ステップ 7: レスポンシブデザインの検証

#### デバイスサイズ

| デバイス | 画面サイズ | テスト内容 |
|---------|----------|-----------|
| **スマホ（縦）** | 375x667px | 基本機能、タップ操作 |
| **スマホ（横）** | 667x375px | レイアウト崩れ |
| **タブレット（縦）** | 768x1024px | レイアウト、操作性 |
| **タブレット（横）** | 1024x768px | レイアウト |
| **PC（小）** | 1280x720px | レイアウト |
| **PC（大）** | 1920x1080px | レイアウト |

#### テスト手順

**Chrome DevToolsを使用:**

1. Chrome DevToolsを開く（F12）
2. デバイスツールバーを開く（Ctrl+Shift+M）
3. 各デバイスサイズに切り替えてテスト

**確認項目:**

- [ ] テキストが読みやすい
- [ ] ボタンがタップしやすい（最小44x44px）
- [ ] 画像が適切なサイズで表示される
- [ ] スクロールが自然
- [ ] フォームが使いやすい
- [ ] レイアウトが崩れていない

---

## パフォーマンステスト

### ステップ 8: Lighthouse監査

#### 実施手順

1. Chrome DevToolsを開く（F12）
2. 「Lighthouse」タブをクリック
3. 「Analyze page load」をクリック

#### 目標スコア

| カテゴリ | 目標スコア |
|---------|----------|
| **Performance** | 90以上 |
| **Accessibility** | 95以上 |
| **Best Practices** | 95以上 |
| **SEO** | 90以上 |

#### パフォーマンス改善項目

**改善が必要な場合:**

- [ ] 画像を最適化（WebP形式、圧縮）
- [ ] 未使用のJavaScriptを削除
- [ ] CSSの最適化
- [ ] フォントの最適化
- [ ] キャッシュの設定

### ステップ 9: レスポンスタイム測定

#### API レスポンスタイムの確認

**測定項目:**

| API | 目標時間 |
|-----|---------|
| `/api/summarize` | 5秒以内 |
| `/api/history` | 1秒以内 |

**測定方法:**

```javascript
// Chrome DevTools Consoleで実行
console.time('API Response');
fetch('/api/summarize', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ url: 'https://example.com/article' })
}).then(() => {
  console.timeEnd('API Response');
});
```

---

## セキュリティチェック

### ステップ 10: セキュリティ脆弱性の確認

#### XSS（Cross-Site Scripting）対策

**テストケース:**

1. URL入力フォームに以下を入力:
   ```
   <script>alert('XSS')</script>
   javascript:alert('XSS')
   ```

**期待される結果:**
- スクリプトが実行されない
- サニタイゼーション処理が機能している

#### SQLインジェクション対策

**確認項目:**
- [ ] Prisma ORMを使用している（パラメータ化されたクエリ）
- [ ] ユーザー入力を直接SQLに挿入していない

#### 環境変数の保護

**確認項目:**
- [ ] `.env.local`がGit除外されている
- [ ] APIキーがクライアントサイドに露出していない
- [ ] Vercel環境変数が正しく設定されている

#### HTTPS確認

**確認項目:**
- [ ] 本番環境でHTTPSが有効
- [ ] HTTPからHTTPSへのリダイレクトが機能

---

## アクセシビリティテスト

### ステップ 11: アクセシビリティの確認

#### キーボード操作

**テスト手順:**
1. Tabキーでフォーカス移動
2. Enterキーでボタンクリック
3. Escapeキーでモーダル閉じる

**確認項目:**
- [ ] すべての要素にTabでアクセス可能
- [ ] フォーカスが視覚的に分かる
- [ ] キーボードだけで全機能が使える

#### スクリーンリーダー対応

**確認項目:**
- [ ] 画像にalt属性が設定されている
- [ ] ボタンに適切なaria-label
- [ ] フォームにlabel要素
- [ ] 見出しが階層的に構成されている

#### コントラスト比

**確認項目:**
- [ ] テキストと背景のコントラスト比が4.5:1以上
- [ ] 重要な要素は7:1以上

---

## バグ修正

### ステップ 12: バグトラッキングと修正

#### バグレポートテンプレート

```markdown
## バグ概要
[バグの簡潔な説明]

## 再現手順
1. [手順1]
2. [手順2]
3. [手順3]

## 期待される動作
[本来どうあるべきか]

## 実際の動作
[現在の不正な動作]

## 環境
- ブラウザ: Chrome 120
- OS: Windows 11
- 画面サイズ: 1920x1080

## スクリーンショット
[必要に応じて添付]

## 優先度
- [ ] Critical（致命的）
- [ ] High（高）
- [ ] Medium（中）
- [ ] Low（低）
```

#### 発見されたバグの記録

**バグリストの作成:**

`docs/ticket/bug/`ディレクトリに以下の形式で記録:
- `bug-001-description.md`
- `bug-002-description.md`

---

## 成果物チェックリスト

### テスト実施完了の確認

#### 機能テスト
- [ ] URL入力機能のテスト完了
- [ ] 要約生成機能のテスト完了
- [ ] 感想コメント生成のテスト完了
- [ ] コピー機能のテスト完了
- [ ] 履歴機能のテスト完了

#### クロスブラウザテスト
- [ ] Chrome テスト完了
- [ ] Firefox テスト完了
- [ ] Safari テスト完了
- [ ] Edge テスト完了
- [ ] Mobile Safari テスト完了
- [ ] Mobile Chrome テスト完了

#### デバイステスト
- [ ] スマホ（縦）テスト完了
- [ ] スマホ（横）テスト完了
- [ ] タブレットテスト完了
- [ ] PCテスト完了

#### パフォーマンステスト
- [ ] Lighthouse Performance 90以上達成
- [ ] Lighthouse Accessibility 95以上達成
- [ ] API レスポンスタイム目標達成

#### セキュリティチェック
- [ ] XSS対策確認完了
- [ ] SQLインジェクション対策確認完了
- [ ] 環境変数保護確認完了
- [ ] HTTPS確認完了

#### アクセシビリティテスト
- [ ] キーボード操作確認完了
- [ ] スクリーンリーダー対応確認完了
- [ ] コントラスト比確認完了

#### バグ修正
- [ ] 発見されたバグをすべて修正
- [ ] Critical/Highバグがゼロ
- [ ] バグレポート作成完了

### ドキュメント更新
- [ ] README.mdに既知の問題を記載
- [ ] バグ修正履歴を記録
- [ ] テスト結果レポートを作成

---

## テスト結果レポート（テンプレート）

```markdown
# テスト結果レポート

**実施日**: 2025-10-23
**実施者**: [名前]

## サマリー
- 総テストケース数: XX件
- 成功: XX件
- 失敗: XX件
- スキップ: XX件

## Lighthouseスコア
- Performance: XX点
- Accessibility: XX点
- Best Practices: XX点
- SEO: XX点

## 発見されたバグ
- Critical: X件
- High: X件
- Medium: X件
- Low: X件

## 修正完了バグ
- [リスト]

## 未修正バグ
- [リスト]

## 備考
[特記事項]
```

---

**Phase 7完了！次はPhase 8: Vercelデプロイ＆プレリリースに進みます。**
